document.addEventListener('DOMContentLoaded', function() {
    // ================================
    // КОНФИГУРАЦИЯ ИГРЫ
    // ================================
    const gameConfig = {
        boardSize: 11,
        teams: [
            { id: 'silver', name: 'Серебро', color: 'silver', score: 0, position: { row: 0, col: 0 } },
            { id: 'oil', name: 'Нефть', color: 'oil', score: 0, position: { row: 10, col: 0 } },
            { id: 'apple', name: 'Яблоко', color: 'apple', score: 0, position: { row: 10, col: 10 } },
            { id: 'nemchenko', name: 'Немченко LIVE', color: 'nemchenko', score: 0, position: { row: 0, col: 10 } }
        ],
        currentTeamIndex: 0,
        diceResult: 0
    };

    // ================================
    // БАЗА ДАННЫХ ВОПРОСОВ (75 вопросов)
    // ================================
    const financeQuestions = {
        multipleChoice: [
            // Вопросы 1-10
            {
                id: 1,
                category: "НКО",
                question: "К какому типу небанковских кредитных организаций (НКО) относится организация, чья основная деятельность — осуществление переводов денежных средств без открытия банковских счетов?",
                options: ["Расчетная НКО", "Депозитно-кредитная НКО", "Платежная НКО", "НКО — центральный контрагент", "Клиринговая НКО"],
                correctAnswer: 2,
                points: 2
            },
            {
                id: 2,
                category: "НКО",
                question: "Какая операция НЕ входит в перечень основных операций расчетной небанковской кредитной организации?",
                options: ["Открытие и ведение банковских счетов юридических лиц", "Осуществление расчетов по поручению юридических лиц", "Инкассация денежных средств", "Привлечение денежных средств физических лиц во вклады", "Валютные операции по банковским счетам юридических лиц"],
                correctAnswer: 3,
                points: 2
            },
            {
            id: 3,
            category: "НКО",
            question: "Какой из перечисленных видов деятельности разрешен для платежной небанковской кредитной организации?",
            options: ["Выдача банковских гарантий", "Выдача кредитов", "Осуществление переводов денежных средств по банковским счетам", "Привлечение вкладов от населения", "Страхование рисков"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 4,
            category: "НКО",
            question: "Основной функцией НКО — центрального контрагента является:",
            options: ["Осуществление розничных денежных переводов", "Аккумулирование средств бюджетов", "Обеспечение клиринга и минимизация рисков на организованных торгах", "Хранение ценностей в индивидуальных банковских сейфах", "Выпуск платежных карт"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 5,
            category: "Регулирование",
            question: "Какой нормативный акт является базовым для регулирования деятельности всех типов НКО в России?",
            options: ["Федеральный закон «О рынке ценных бумаг»", "Федеральный закон «О Центральном банке Российской Федерации (Банке России)»", "Федеральный закон «Об акционерных обществах»", "Гражданский кодекс Российской Федерации", "Федеральный закон «О микрофинансовой деятельности»"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 6,
            category: "НКО",
            question: "Депозитно-кредитная НКО имеет право:",
            options: ["Открывать счета физическим лицам для расчетов", "Выполнять функции центрального контрагента на бирже", "Привлекать денежные средства только юридических лиц во вклады и размещать их от своего имени", "Осуществлять эмиссию банковских карт", "Страховать вклады"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 7,
            category: "Регулирование",
            question: "Ключевая особенность регулирования деятельности НКО по сравнению с банками заключается в:",
            options: ["Запрете на проведение всего спектра банковских операций и специализации на ограниченном круге услуг", "Полном отсутствии надзора со стороны Банка России", "Более мягких требованиях к размеру собственных средств (капитала)", "Освобождении от обязательного резервирования", "Возможности не раскрывать информацию о владельцах"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 8,
            category: "История",
            question: "Основная историческая функция почтово-сберегательных институтов — это:",
            options: ["Кредитование крупного бизнеса", "Аккумуляция мелких сбережений широких слоев населения и их доступность через сеть почтовых отделений", "Торговля на валютном рынке", "Проведение IPO для компаний", "Страхование имущества"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 9,
            category: "Почтово-сберегательные системы",
            question: "Какая операция характерна для почтово-сберегательной системы?",
            options: ["Андеррайтинг ценных бумаг", "Прием коммунальных платежей от населения", "Выдача ипотечных кредитов", "Управление пенсионными накоплениями", "Доверительное управление активами"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 10,
            category: "НКО",
            question: "Главное отличие расчетной НКО от платежной НКО состоит в том, что расчетная НКО:",
            options: ["Работает только с физическими лицами", "Имеет право открывать и вести банковские счетов юридических лиц, а платежная — нет", "Не поднадзорна Банку России", "Может привлекать вклады", "Осуществляет страхование рисков"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 11,
            category: "Инфраструктура",
            question: "Что из перечисленного НЕ относится к основным элементам инфраструктуры кредитной системы?",
            options: ["Платёжные системы", "Система кредитных бюро", "Аудиторские компании", "Центральный банк"],
            correctAnswer: 3,
            points: 2
        },
        {
            id: 12,
            category: "Инфраструктура",
            question: "Основная функция кредитных бюро в инфраструктуре кредитной системы — это:",
            options: ["Страхование кредитных рисков", "Аккумуляция и предоставление кредитных историй заёмщиков", "Проведение денежно-кредитной политики", "Рефинансирование коммерческих банков"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 13,
            category: "Экономика",
            question: "Через какой механизм кредитная система напрямую влияет на формирование внутреннего инвестиционного спроса?",
            options: ["Через регулирование курса национальной валюты", "Через перераспределение сбережений в инвестиции", "Через установление цен на товары", "Через финансирование государственного бюджета"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 14,
            category: "Инфраструктура",
            question: "Какой элемент инфраструктуры снижает операционные риски при проведении межбанковских расчётов?",
            options: ["Платёжно-клиринговая система", "Система страхования вкладов", "Коллекторские агентства", "Рейтинговые агентства"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 15,
            category: "Экономика",
            question: "Роль кредитной системы в национальной экономике проявляется в:",
            options: ["Замещении функций государства", "Обеспечении перераспределения капитала между секторами экономики", "Установлении налоговых ставок", "Регулировании внешней торговли"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 16,
            category: "Инфраструктура",
            question: "Ключевой институт, обеспечивающий стабильность банковской системы через гарантирование вкладов, — это:",
            options: ["Агентство по страхованию вкладов (АСВ)", "Министерство финансов", "Фондовая биржа", "Центральный банк"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 17,
            category: "Экономика",
            question: "Формирование внутреннего инвестиционного спроса зависит от кредитной системы, так как она:",
            options: ["Определяет размеры бюджетного дефицита", "Контролирует деятельность страховых компаний", "Устанавливает нормы обязательного резервирования", "Обеспечивает трансформацию сбережений в кредиты для бизнеса"],
            correctAnswer: 3,
            points: 2
        },
        {
            id: 18,
            category: "Инфраструктура",
            question: "Какой элемент НЕ является частью финансовой инфраструктуры, обслуживающей кредитную систему?",
            options: ["Депозитарии", "Биржи", "Аудиторские фирмы", "Производственные предприятия"],
            correctAnswer: 3,
            points: 2
        },
        {
            id: 19,
            category: "Инфраструктура",
            question: "Основная цель создания инфраструктуры кредитной системы — это:",
            options: ["Максимизация прибыли банков", "Обеспечение стабильности и эффективности кредитных отношений", "Замещение наличного денежного обращения", "Сокращение числа кредитных организаций"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 20,
            category: "Экономика",
            question: "Каким образом развитая кредитная система влияет на внутренний инвестиционный спрос в условиях экономического спада?",
            options: ["Смягчает спад, предоставляя доступ к финансированию для бизнеса и домохозяйств", "Усиливает спад, сокращая выдачу кредитов", "Не оказывает значимого влияния на инвестиционный спрос", "Приводит к оттоку капитала за рубеж"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 21,
            category: "Факторинг",
            question: "Основная цель факторинговой компании — это:",
            options: ["Долгосрочное кредитование инвестиционных проектов", "Покупка дебиторской задолженности поставщика с немедленной оплатой большей части долга", "Приобретение дорогостоящего оборудования с последующей сдачей его в аренду", "Обеспечение гарантий по внешнеэкономическим сделкам"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 22,
            category: "Лизинг",
            question: "Лизинговая компания по своей сути является:",
            options: ["Инвестиционной компанией, специализирующейся на венчурных проектах", "Посредником, совмещающим функции кредитора и арендодателя", "Торговой организацией, продающей оборудование в рассрочку", "Страховой компанией, покрывающей риски утраты имущества"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 23,
            category: "Форфейтинг",
            question: "Чем форфейтинг принципиально отличается от факторинга?",
            options: ["Форфейтинг всегда дешевле для клиента", "Форфейтинг ориентирован на разовые, средние и долгосрочные внешнеторговые сделки с использованием оборотных инструментов", "Форфейтинг предполагает регресс (обратное требование) к поставщику в случае неуплаты", "Форфейтинг не предполагает дисконтирования платежных требований"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 24,
            category: "Лизинг",
            question: "Ключевое различие между лизингом и кредитом на покупку оборудования состоит в том, что:",
            options: ["При лизинге право собственности на актив остается у финансирующей стороны на весь срок договора", "Кредит всегда выгоднее с налоговой точки зрения", "Лизинг доступен только для юридических лиц, а кредит — и для физических", "Лизинг предполагает более высокую процентную ставку, чем кредит"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 25,
            category: "Ломбарды",
            question: "Если клиент не выкупил заложенную в ломбарде вещь в срок, ломбард вправе:",
            options: ["Бессрочно хранить вещь, ожидая выплаты долга", "Передать вещь в суд для принятия решения", "Реализовать ее с публичных торгов", "Безвозмездно передать ее государству"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 26,
            category: "КПК",
            question: "Какая из перечисленных организаций может привлекать деньги граждан только в виде членских взносов и паев, а не вкладов?",
            options: ["Банк", "Ломбард", "Кредитный потребительский кооператив (КПК)", "Микрофинансовая компания (МФК)"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 27,
            category: "Лизинг",
            question: "В чем состоит основная функция лизинговой компании как НФО?",
            options: ["Передача клиенту имущества в долгосрочную аренду с правом последующего выкупа", "Выдача краткосрочных займов под залог имущества", "Обмен валюты для юридических лиц", "Проведение операций на фондовой бирже по поручению клиента", "Оценка стоимости недвижимости"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 28,
            category: "МФО",
            question: "Ключевое отличие микрофинансовой организации (МФО) от банка заключается в том, что МФО:",
            options: ["Имеет право выдавать кредиты только юридическим лицам", "Не имеет права привлекать денежные средства во вклады", "Работает под контролем Министерства финансов, а не Центрального банка", "Выдает кредиты исключительно под залог имущества", "Не имеет возможности использовать электронные средства платежа"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 29,
            category: "Регулирование",
            question: "Кто такие «профессиональные кредиторы» в соответствии с российским законодательством?",
            options: ["Только банки, имеющие универсальную лицензию", "Любые юридические лица, выдавшие более 5 кредитов за год", "Юридические лица и ИП, для которых предоставление займов является профессиональной деятельностью (МФО, ломбарды, КПК)", "Частные лица, занимающиеся ростовщичеством", "Только коллекторские агентства"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 30,
            category: "Специализированные организации",
            question: "Что из перечисленного НЕ является основной задачей специализированной кредитной организации?",
            options: ["Выдавать займы определенного вида (например, под залог машин)", "Обслуживать пластиковые карты всех международных систем", "Помогать с финансированием покупки жилья для своих членов в кооперативе", "Оказывать услуги микрофинансирования"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 31,
            category: "Регулирование",
            question: "Какой институт является высшим органом банковского регулирования и надзора в России?",
            options: ["Министерство финансов РФ", "Банк России (Центральный банк РФ)", "Федеральное казначейство", "Росфинмониторинг"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 32,
            category: "Структура",
            question: "Какой из перечисленных элементов НЕ входит в институциональную структуру кредитной системы РФ?",
            options: ["Банки", "Страховые компании", "Министерство экономического развития", "Негосударственные пенсионные фонды (НПФ)"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 33,
            category: "Ломбарды",
            question: "К какой группе финансовых организаций, согласно законодательству, относятся ломбарды?",
            options: ["Кредитные организации", "Небанковские кредитные организации (НКО)", "Брокерские компании", "Страховщики"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 34,
            category: "Специализированные институты",
            question: "Что из перечисленного относится к специализированным финансовым институтам?",
            options: ["Коммерческий банк", "Лизинговая компания", "Платежный агент", "Фондовая биржа"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 35,
            category: "НКО",
            question: "Какой вид НКО имеет право привлекать вклады физических лиц?",
            options: ["НКО, осуществляющие инкассацию", "НКО — депозитно-кредитные", "Расчетные НКО", "Платежные НКО"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 36,
            category: "Структура",
            question: "Банковский сектор в структуре кредитной системы РФ включает:",
            options: ["Только кредитные организации (банки и НКО)", "Все финансовые организации, имеющие лицензию ЦБ", "Банки, страховые компании и МФО", "Только системно значимые банки"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 37,
            category: "ЦБ",
            question: "Ключевая функция Банка России в кредитной системе — это:",
            options: ["Кредитование малого бизнеса", "Проведение денежно-кредитной политики", "Конкуренция с коммерческими банками", "Привлечение частных вкладов"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 38,
            category: "НКО",
            question: "Что из перечисленного НЕ является небанковской кредитной организацией (НКО)?",
            options: ["Клиринговая компания", "Микрофинансовая организация (МФО)", "Расчетная палата", "Депозитно-кредитная НКО"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 39,
            category: "Пенсионная система",
            question: "Какой вид финансовых организаций осуществляет деятельность по обязательному пенсионному страхованию?",
            options: ["Страховые компании", "Пенсионный фонд РФ (государственный) и НПФ", "Управляющие компании паевых фондов", "Кредитные потребительские кооперативы"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 40,
            category: "Структура",
            question: "Кто является основным участником второго уровня кредитной системы (институционального)?",
            options: ["Коммерческие банки и небанковские финансово-кредитные институты", "Банк России и Правительство РФ", "Федеральная налоговая служба", "Международные финансовые организации"],
            correctAnswer: 0,
            points: 2
        },
        {
            id: 41,
            category: "Основы",
            question: "Какой элемент относится к фундаментальной основе кредитной системы?",
            options: ["Денежно-кредитная политика", "Кредитные отношения", "Акцизная политика", "Инвестиционный анализ"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 42,
            category: "Принципы",
            question: "Какой принцип организации кредитной системы направлен на поддержание устойчивости и предотвращение кризисов?",
            options: ["Принцип оперативности", "Принцип сбалансированности", "Принцип автономности", "Принцип расширенного воспроизводства"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 43,
            category: "Защита",
            question: "Какой регулирующий механизм обеспечивает защиту интересов вкладчиков?",
            options: ["Валютный контроль", "Система страхования вкладов", "Антимонопольный контроль", "Бюджетное правило"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 44,
            category: "Системы",
            question: "Что отличает децентрализованную кредитную систему?",
            options: ["Отсутствие коммерческих банков", "Монополия государства на кредит", "Существование большого числа самостоятельных кредитных институтов", "Запрет на международные расчеты"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 45,
            category: "Центр",
            question: "Какой элемент является организационным центром кредитной системы?",
            options: ["Федеральное казначейство", "Центральный банк", "Минфин", "Налоговая служба"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 46,
            category: "Финансовый рынок",
            question: "Что характеризует кредитную систему как часть финансового рынка?",
            options: ["Ориентация только на государственные финансы", "Работа исключительно с ценными бумагами", "Обслуживание движения заемного капитала", "Управление государственным долгом"],
            correctAnswer: 2,
            points: 2
        },
        {
            id: 47,
            category: "История",
            question: "Какой тип кредитной системы исторически связан с командной экономикой?",
            options: ["Универсальная", "Монобанковская", "Коммерческая", "Смешанная"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 48,
            category: "Сравнение",
            question: "Какая особенность финансовой системы отличает её от кредитной?",
            options: ["Обслуживание процессов кредитования", "Обслуживание распределения и использования финансовых ресурсов", "Проведение клиринговых операций", "Предоставление краткосрочных займов"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 49,
            category: "Инфраструктура",
            question: "Какой институт обеспечивает связь между кредитной системой и рынком капитала?",
            options: ["Ломбарды", "Фондовые биржи", "Почтовые отделения", "Страховые агентства"],
            correctAnswer: 1,
            points: 2
        },
        {
            id: 50,
            category: "Инвестиции",
            question: "Как кредитная система влияет на инвестиционную активность?",
            options: ["Через финансирование государственных расходов", "Через механизм кредитования и рефинансирования", "Через контроль инфляции в магазинах", "Через регулирование зарплат"],
            correctAnswer: 1,
            points: 2
        }

            // ... (вставьте остальные 48 вопросов с вариантами из предыдущего кода)
            // Для краткости я сокращаю, но в полной версии здесь должны быть все 50 вопросов
        ],
        openQuestions: [
            // Вопросы 51-75
            {
                id: 51,
                category: "НКО",
                question: "Назовите тип НКО, которая организует торги на рынке ценных бумаг и берет на себя риски неисполнения сделок участниками.",
                correctAnswer: "НКО — центральный контрагент (НКО ЦК)",
                points: 3
            },
            {
                id: 52,
                category: "Лицензирование",
                question: "Как называется основной документ (лицензия), дающий НКО право на осуществление деятельности?",
                correctAnswer: "Разрешение (лицензия) Банка России",
                points: 3
            },
            {
            id: 53,
            category: "НКО",
            question: "Какую единственную банковскую операцию из перечня Закона «О банках и банковской деятельности» имеет право проводить депозитно-кредитная НКО?",
            correctAnswer: "Привлечение денежных средств юридических лиц во вклады (депозиты)",
            points: 3
        },
        {
            id: 54,
            category: "Регулирование",
            question: "Какой орган является мегарегулятором и осуществляет надзор за всеми НКО в Российской Федерации?",
            correctAnswer: "Банк России (Центральный банк РФ)",
            points: 3
        },
        {
            id: 55,
            category: "НКО",
            question: "Какая принципиальная операция из перечня банковских операций законодательно запрещена для платежной НКО, работающей только с переводами без открытия счетов?",
            correctAnswer: "Открытие и ведение банковских счетов",
            points: 3
        },
        {
            id: 56,
            category: "Страхование",
            question: "Назовите институт, который в России осуществляет обязательное страхование вкладов физических лиц.",
            correctAnswer: "Агентство по страхованию вкладов (АСВ)",
            points: 3
        },
        {
            id: 57,
            category: "Экономика",
            question: "Какой процесс в экономике описывает превращение банковских депозитов в кредиты для инвестиций?",
            correctAnswer: "Кредитная мультипликация (или мультипликация кредита)",
            points: 3
        },
        {
            id: 58,
            category: "Инфраструктура",
            question: "Какой элемент инфраструктуры отвечает за сбор и хранение информации о платёжной дисциплине заёмщиков?",
            correctAnswer: "Кредитные бюро (Бюро кредитных историй)",
            points: 3
        },
        {
            id: 59,
            category: "Кредитование",
            question: "Какой сегмент кредитования в России наиболее важен для стимулирования внутреннего инвестиционного спроса в регионах?",
            correctAnswer: "Кредитование малого и среднего предпринимательства (МСП)",
            points: 3
        },
        {
            id: 60,
            category: "Экономика",
            question: "Какую роль в экономике играет способность кредитной системы снижать риск ликвидности для вкладчиков и заёмщиков?",
            correctAnswer: "Повышение эффективности трансформации сбережений в инвестиции / Стимулирование долгосрочных инвестиций",
            points: 3
        },
        {
            id: 61,
            category: "Регулирование",
            question: "Кто в основном осуществляет контроль за деятельностью МФО, ломбардов и кредитных кооперативов?",
            correctAnswer: "Центральный банк Российской Федерации (Банк России)",
            points: 3
        },
        {
            id: 62,
            category: "МФО",
            question: "Какую основную функцию выполняют МФО и ломбарды на финансовом рынке?",
            correctAnswer: "Они обеспечивают доступ к быстрым займам для тех, кому банки часто отказывают",
            points: 3
        },
        {
            id: 63,
            category: "Ломбарды",
            question: "Какую услугу, помимо выдачи займов, часто оказывают ломбарды?",
            correctAnswer: "Хранение ценностей",
            points: 3
        },
        {
            id: 64,
            category: "Ломбарды",
            question: "Что является главным преимуществом ломбардного кредита для заемщика?",
            correctAnswer: "Скорость получения денег и минимальные требования (без проверки кредитной истории)",
            points: 3
        },
        {
            id: 65,
            category: "Факторинг",
            question: "Заполните пропуск: «_____ - это организация, которая может купить долг вашего клиента, чтобы вы сразу получили деньги, а она сама потом будет заниматься его взысканием».",
            correctAnswer: "Факторинговая компания",
            points: 3
        },
        {
            id: 66,
            category: "Банки",
            question: "Назовите тип кредитной организации, которая имеет исключительное право на открытие и ведение банковских счетов юридических и физических лиц.",
            correctAnswer: "Банк",
            points: 3
        },
        {
            id: 67,
            category: "Законодательство",
            question: "Как называется основной закон, регулирующий деятельность банков и НКО в России?",
            correctAnswer: "Федеральный закон «О банках и банковской деятельности»",
            points: 3
        },
        {
            id: 68,
            category: "НКО",
            question: "Назовите вид небанковской кредитной организации, основная функция которой — осуществление расчетов (например, между юрлицами).",
            correctAnswer: "Расчетная НКО",
            points: 3
        },
        {
            id: 69,
            category: "Инвестиции",
            question: "Какой небанковский финансовый институт привлекает средства для их последующего инвестирования в ценные бумаги от имени инвесторов?",
            correctAnswer: "Паевой инвестиционный фонд (ПИФ) / Управляющая компания",
            points: 3
        },
        {
            id: 70,
            category: "Инвестиции",
            question: "Какой небанковский институт осуществляет профессиональную деятельность на рынке ценных бумаг по управлению инвестиционными портфелями?",
            correctAnswer: "Управляющая компания",
            points: 3
        },
        {
            id: 71,
            category: "Принципы",
            question: "Как называется методологический принцип, требующий согласованности всех уровней кредитной системы?",
            correctAnswer: "Принцип системности",
            points: 3
        },
        {
            id: 72,
            category: "История",
            question: "Как называется тип кредитной системы, в которой кредитование сосредоточено в едином государственном банке?",
            correctAnswer: "Монобанковская система",
            points: 3
        },
        {
            id: 73,
            category: "ЦБ",
            question: "Как именуется ключевой финансовый институт, осуществляющий эмиссию национальной валюты и регулирование кредита?",
            correctAnswer: "Центральный банк",
            points: 3
        },
        {
            id: 74,
            category: "Экономика",
            question: "Какой термин обозначает процесс перераспределения денежных ресурсов между субъектами экономики через кредит?",
            correctAnswer: "Движение (или перераспределение) ссудного капитала",
            points: 3
        },
        {
            id: 75,
            category: "Рынки",
            question: "Как называется часть финансового рынка, где осуществляется предоставление и получение кредитов?",
            correctAnswer: "Кредитный рынок",
            points: 3
        }
            // ... (вставьте остальные 23 открытых вопроса)
        ]
    };


    // ================================
    // ДЕТЕРМИНИРОВАННОЕ РАСПРЕДЕЛЕНИЕ КЛЕТОК
    // ================================
    // Карта распределения типов клеток (11x11)
    const cellDistribution = [
        // 0   1   2   3   4   5   6   7   8   9   10
        ['X', 'Q', 'Q', 'B', 'Q', 'I', 'Q', 'G', 'Q', 'T', 'X'], // 0
        ['Q', 'G', 'Q', 'T', 'Q', 'I', 'Q', 'P', 'Q', 'G', 'Q'], // 1
        ['Q', 'T', 'Q', 'I', 'Q', 'P', 'Q', 'G', 'Q', 'T', 'Q'], // 2
        ['B', 'Q', 'I', 'Q', 'P', 'Q', 'G', 'Q', 'T', 'Q', 'G'], // 3
        ['Q', 'P', 'Q', 'G', 'Q', 'T', 'Q', 'I', 'Q', 'P', 'Q'], // 4
        ['I', 'I', 'Q', 'T', 'Q', 'I', 'Q', 'P', 'Q', 'G', 'B'], // 5
        ['Q', 'P', 'Q', 'G', 'Q', 'T', 'Q', 'I', 'Q', 'P', 'Q'], // 6
        ['B', 'Q', 'G', 'Q', 'T', 'Q', 'I', 'Q', 'P', 'Q', 'I'], // 7
        ['Q', 'T', 'Q', 'P', 'Q', 'G', 'Q', 'T', 'Q', 'I', 'Q'], // 8
        ['Q', 'G', 'Q', 'I', 'Q', 'P', 'Q', 'G', 'Q', 'T', 'Q'], // 9
        ['X', 'Q', 'T', 'Q', 'B', 'Q', 'P', 'Q', 'G', 'Q', 'X']  // 10
    ];
    
    // Легенда:
    // X - Стартовая клетка (команда)
    // Q - Вопрос (75 штук)
    // G - Грабеж балла (15)
    // T - Передача хода (10)
    // I - Инвестиционный бонус +3 (10)
    // P - Инвестиционные потери -2 (7)
    // B - Пустая бонусная клетка (оставшиеся 4)

    // Карта распределения конкретных вопросов
    const questionMap = new Map();
    let questionCounter = 1;

    // Карта распределения бонусов
    const bonusMap = new Map();

    // ================================
    // СОСТОЯНИЕ ИГРЫ
    // ================================
    let gameState = {
        board: [],
        pieces: {},
        activeTeam: null,
        selectedDirection: null,
        isMoving: false,
        currentQuestion: null,
        currentBonus: null
    };

    // ================================
    // ИНИЦИАЛИЗАЦИЯ ИГРЫ
    // ================================
    function initGame() {
        initializeMaps();
        createBoard();
        createPieces();
        setupEventListeners();
        updateScoreDisplay();
        setActiveTeam(0);
        showNotification('Игра началась! Первыми ходят Серебро.', 'info');
    }

    // Инициализация карт распределения
    function initializeMaps() {
        // Распределяем вопросы по клеткам с типом 'Q'
        let questionId = 1;
        
        for (let row = 0; row < 11; row++) {
            for (let col = 0; col < 11; col++) {
                const cellType = cellDistribution[row][col];
                
                if (cellType === 'Q') {
                    // Присваиваем вопрос
                    questionMap.set(`${row}-${col}`, questionId);
                    questionId++;
                    
                    // Если вопросы закончились, начинаем сначала
                    if (questionId > 75) questionId = 1;
                } else if (['G', 'T', 'I', 'P', 'B'].includes(cellType)) {
                    // Присваиваем бонус
                    bonusMap.set(`${row}-${col}`, cellType);
                }
            }
        }
        
        console.log(`Распределено вопросов: ${questionMap.size}`);
        console.log(`Распределено бонусов: ${bonusMap.size}`);
    }

    // ================================
    // СОЗДАНИЕ ИГРОВОГО ПОЛЯ
    // ================================
    function createBoard() {
        const board = document.getElementById('game-board');
        board.innerHTML = '';
        gameState.board = [];
        
        for (let row = 0; row < gameConfig.boardSize; row++) {
            gameState.board[row] = [];
            for (let col = 0; col < gameConfig.boardSize; col++) {
                const cell = document.createElement('div');
                cell.className = 'cell closed';
                cell.dataset.row = row;
                cell.dataset.col = col;
                
                // Получаем тип клетки из распределения
                const cellType = cellDistribution[row][col];
                
                // Проверяем, является ли клетка стартовой
                let isStartCell = false;
                gameConfig.teams.forEach(team => {
                    if (team.position.row === row && team.position.col === col) {
                        isStartCell = true;
                    }
                });
                
                if (isStartCell) {
                    // Стартовая клетка команды
                    cell.dataset.type = 'start';
                    cell.dataset.used = 'true';
                    cell.classList.remove('closed');
                    cell.classList.add('used');
                    cell.title = 'Стартовая клетка';
                } else if (cellType === 'Q') {
                    // Клетка с вопросом
                    cell.dataset.type = 'question';
                    const questionId = questionMap.get(`${row}-${col}`);
                    cell.dataset.questionId = questionId;
                    cell.dataset.used = 'false';
                    cell.title = `Вопрос №${questionId}`;
                } else if (['G', 'T', 'I', 'P', 'B'].includes(cellType)) {
                    // Клетка с бонусом
                    cell.dataset.type = 'bonus';
                    cell.dataset.bonusType = cellType;
                    cell.dataset.used = 'false';
                    
                    // Устанавливаем подсказку
                    const bonusTitles = {
                        'G': 'Грабеж: -1 балл у выбранной команды',
                        'T': 'Передача хода: следующий ход у выбранной команды',
                        'I': 'Инвестиционный бонус: +3 балла',
                        'P': 'Инвестиционные потери: -2 балла',
                        'B': 'Бонусная клетка'
                    };
                    cell.title = bonusTitles[cellType] || 'Бонусная клетка';
                }
                
                board.appendChild(cell);
                gameState.board[row][col] = cell;
            }
        }
    }

    // ================================
    // СОЗДАНИЕ ФИШЕК
    // ================================
    function createPieces() {
        gameState.pieces = {};
        
        gameConfig.teams.forEach(team => {
            const piece = document.createElement('div');
            piece.className = `piece ${team.color}`;
            piece.id = `piece-${team.id}`;
            piece.textContent = team.name;
            
            const cell = gameState.board[team.position.row][team.position.col];
            cell.appendChild(piece);
            
            piece.style.position = 'absolute';
            piece.style.top = '10%';
            piece.style.left = '10%';
            
            gameState.pieces[team.id] = piece;
        });
    }

    // ================================
    // НАСТРОЙКА ОБРАБОТЧИКОВ СОБЫТИЙ
    // ================================
    function setupEventListeners() {
        // Кнопка броска кубика
        document.getElementById('dice-btn').addEventListener('click', rollDice);
        
        // Кнопка сброса игры
        document.getElementById('reset-btn').addEventListener('click', resetGame);
        
        // Кнопки направления
        document.querySelectorAll('.dir-btn').forEach(btn => {
            if (btn.dataset.dir) {
                btn.addEventListener('click', () => selectDirection(btn.dataset.dir));
            }
        });
        
        // Кнопка подтверждения направления
        document.getElementById('confirm-direction').addEventListener('click', confirmDirection);
        
        // Модальные окна
        document.getElementById('close-question').addEventListener('click', () => {
            document.getElementById('question-modal').style.display = 'none';
        });
        
        document.getElementById('close-bonus').addEventListener('click', () => {
            document.getElementById('bonus-modal').style.display = 'none';
        });
        
        // Кнопки ответа на вопрос
        document.getElementById('correct-btn').addEventListener('click', () => answerQuestion(true));
        document.getElementById('wrong-btn').addEventListener('click', () => answerQuestion(false));
        
        // Кнопка подтверждения бонуса
        document.getElementById('confirm-bonus').addEventListener('click', confirmBonus);
    }

    // ================================
    // ИГРОВАЯ ЛОГИКА
    // ================================
    function rollDice() {
        if (gameState.isMoving) return;
        
        const diceBtn = document.getElementById('dice-btn');
        const diceResult = document.getElementById('dice-result');
        
        diceBtn.disabled = true;
        diceResult.textContent = '...';
        
        let rolls = 0;
        const rollInterval = setInterval(() => {
            diceResult.textContent = Math.floor(Math.random() * 6) + 1;
            rolls++;
            
            if (rolls > 10) {
                clearInterval(rollInterval);
                const result = Math.floor(Math.random() * 6) + 1;
                gameConfig.diceResult = result;
                diceResult.textContent = result;
                
                showNotification(`Выпало: ${result}! Выберите направление движения.`, 'dice');
                diceBtn.disabled = false;
                
                // Включаем кнопки направления
                document.querySelectorAll('.dir-btn').forEach(btn => {
                    if (btn.dataset.dir) {
                        btn.disabled = false;
                    }
                });
                document.getElementById('confirm-direction').disabled = false;
            }
        }, 100);
    }

    function selectDirection(direction) {
        if (gameConfig.diceResult === 0) {
            showNotification('Сначала бросьте кубик!', 'warning');
            return;
        }
        
        gameState.selectedDirection = direction;
        
        document.querySelectorAll('.dir-btn').forEach(btn => {
            btn.classList.remove('selected');
            if (btn.dataset.dir === direction) {
                btn.classList.add('selected');
            }
        });
        
        showNotification(`Выбрано направление: ${getDirectionName(direction)}`, 'info');
    }

    function getDirectionName(dir) {
        const names = {
            'up': 'Вверх',
            'down': 'Вниз',
            'left': 'Влево',
            'right': 'Вправо'
        };
        return names[dir] || dir;
    }

    function confirmDirection() {
        if (!gameState.selectedDirection || gameConfig.diceResult === 0) {
            showNotification('Сначала выберите направление!', 'warning');
            return;
        }
        
        if (gameState.isMoving) return;
        
        // Блокируем кнопки направления
        document.querySelectorAll('.dir-btn').forEach(btn => {
            btn.disabled = true;
        });
        document.getElementById('confirm-direction').disabled = true;
        
        // Двигаем фишку
        gameState.isMoving = true;
        const currentTeam = gameConfig.teams[gameConfig.currentTeamIndex];
        
        // Вычисляем новую позицию
        let newRow = currentTeam.position.row;
        let newCol = currentTeam.position.col;
        
        for (let i = 0; i < gameConfig.diceResult; i++) {
            switch (gameState.selectedDirection) {
                case 'up': newRow--; break;
                case 'down': newRow++; break;
                case 'left': newCol--; break;
                case 'right': newCol++; break;
            }
            
            // Проверка границ поля
            if (newRow < 0) newRow = 0;
            if (newRow >= gameConfig.boardSize) newRow = gameConfig.boardSize - 1;
            if (newCol < 0) newCol = 0;
            if (newCol >= gameConfig.boardSize) newCol = gameConfig.boardSize - 1;
        }
        
        // Анимация движения
        movePiece(currentTeam, newRow, newCol);
    }

    function movePiece(team, newRow, newCol) {
        const piece = gameState.pieces[team.id];
        const oldCell = gameState.board[team.position.row][team.position.col];
        const newCell = gameState.board[newRow][newCol];
        
        oldCell.removeChild(piece);
        newCell.appendChild(piece);
        team.position.row = newRow;
        team.position.col = newCol;
        
        piece.style.transition = 'all 0.5s ease';
        
        setTimeout(() => {
            gameState.isMoving = false;
            checkCell(newCell, team);
            
            // Сбрасываем направление и результат кубика
            gameState.selectedDirection = null;
            gameConfig.diceResult = 0;
            document.getElementById('dice-result').textContent = '';
            
            // Снимаем выделение с кнопок направления
            document.querySelectorAll('.dir-btn').forEach(btn => {
                btn.classList.remove('selected');
                btn.disabled = true;
            });
            document.getElementById('confirm-direction').disabled = true;
            
        }, 500);
    }

    function checkCell(cell, team) {
        if (cell.dataset.used === 'true') {
            showNotification(`Команда "${team.name}" на уже использованной клетке.`, 'info');
            nextTurn();
            return;
        }
        
        cell.dataset.used = 'true';
        cell.classList.remove('closed');
        
        const cellType = cell.dataset.type;
        
        switch (cellType) {
            case 'question':
                cell.classList.add('question');
                showQuestion(cell, team);
                break;
                
            case 'bonus':
                cell.classList.add('bonus');
                showBonus(cell, team);
                break;
                
            default:
                cell.classList.add('used');
                nextTurn();
        }
    }

    // ================================
    // РАБОТА С ВОПРОСАМИ
    // ================================
    function showQuestion(cell, team) {
        const questionId = parseInt(cell.dataset.questionId);
        
        // Находим вопрос
        let question;
        if (questionId <= 50) {
            question = financeQuestions.multipleChoice.find(q => q.id === questionId);
        } else {
            question = financeQuestions.openQuestions.find(q => q.id === questionId);
        }
        
        if (!question) {
            console.error(`Вопрос с ID ${questionId} не найден!`);
            showNotification('Ошибка загрузки вопроса. Переход хода.', 'error');
            nextTurn();
            return;
        }
        
        // Сохраняем текущий вопрос в состоянии
        gameState.currentQuestion = {
            question: question,
            team: team,
            cell: cell
        };
        
        // Обновляем интерфейс
        document.getElementById('question-text').textContent = question.question;
        document.getElementById('question-category').textContent = `Категория: ${question.category} | Вопрос №${questionId}`;
        
        const optionsContainer = document.getElementById('options-container');
        optionsContainer.innerHTML = '';
        
        if (question.options) {
            // Вопрос с вариантами ответов
            optionsContainer.style.display = 'block';
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                optionElement.dataset.index = index;
                
                optionElement.addEventListener('click', () => {
                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    optionElement.classList.add('selected');
                    
                    // Показываем правильный ответ для проверки
                    const resultElement = document.getElementById('answer-result');
                    if (index === question.correctAnswer) {
                        resultElement.textContent = '✓ Это правильный ответ!';
                        resultElement.style.color = '#4caf50';
                    } else {
                        const correctLetter = String.fromCharCode(65 + question.correctAnswer);
                        resultElement.textContent = `✗ Правильный ответ: ${correctLetter}) ${question.options[question.correctAnswer]}`;
                        resultElement.style.color = '#f44336';
                    }
                });
                
                optionsContainer.appendChild(optionElement);
            });
        } else {
            // Открытый вопрос
            optionsContainer.style.display = 'none';
            document.getElementById('answer-result').textContent = '';
        }
        
        // Показываем модальное окно
        document.getElementById('question-modal').style.display = 'flex';
    }

    function answerQuestion(isCorrect) {
        const question = gameState.currentQuestion.question;
        const team = gameState.currentQuestion.team;
        const cell = gameState.currentQuestion.cell;
        
        if (isCorrect) {
            team.score += question.points;
            showNotification(`Правильно! Команда "${team.name}" получает ${question.points} балла!`, 'success');
        } else {
            showNotification(`Неправильно. Баллы не начислены.`, 'warning');
        }
        
        updateScoreDisplay();
        document.getElementById('question-modal').style.display = 'none';
        
        // Обновляем клетку
        cell.classList.remove('question');
        cell.classList.add('used');
        
        nextTurn();
    }

    // ================================
    // РАБОТА С БОНУСАМИ
    // ================================
    function showBonus(cell, team) {
        const bonusType = cell.dataset.bonusType;
        
        // Сохраняем текущий бонус в состоянии
        gameState.currentBonus = {
            type: bonusType,
            team: team,
            cell: cell
        };
        
        const modal = document.getElementById('bonus-modal');
        const title = document.getElementById('bonus-title');
        const icon = document.getElementById('bonus-icon');
        const resultElement = document.getElementById('bonus-result');
        
        // Очищаем предыдущие классы
        resultElement.className = 'bonus-result';
        
        switch (bonusType) {
            case 'G': // Грабеж
                title.innerHTML = `<i class="fas fa-user-ninja"></i> ГРАБЕЖ`;
                icon.innerHTML = '<i class="fas fa-user-ninja fa-4x"></i>';
                
                // Случайно выбираем команду для грабежа (кроме текущей)
                const otherTeams = gameConfig.teams.filter(t => t.id !== team.id);
                const randomTeam = otherTeams[Math.floor(Math.random() * otherTeams.length)];
                
                if (randomTeam.score > 0) {
                    randomTeam.score -= 1;
                    team.score += 1;
                    resultElement.innerHTML = `
                        <div>Вы ограбили команду "${randomTeam.name}"!</div>
                        <div style="font-size: 3rem; margin: 10px 0;">+1 балл</div>
                        <div>Теперь у вас: ${team.score} баллов</div>
                    `;
                    resultElement.classList.add('positive');
                } else {
                    resultElement.innerHTML = `
                        <div>Команда "${randomTeam.name}" не имеет баллов для грабежа</div>
                        <div style="font-size: 3rem; margin: 10px 0;">0</div>
                        <div>У вас осталось: ${team.score} баллов</div>
                    `;
                    resultElement.classList.add('neutral');
                }
                break;
                
            case 'T': // Передача хода
                title.innerHTML = `<i class="fas fa-exchange-alt"></i> ПЕРЕДАЧА ХОДА`;
                icon.innerHTML = '<i class="fas fa-exchange-alt fa-4x"></i>';
                
                // Случайно выбираем команду для передачи хода
                const availableTeams = gameConfig.teams.filter(t => t.id !== team.id);
                const transferTeam = availableTeams[Math.floor(Math.random() * availableTeams.length)];
                
                // Находим индекс команды для передачи
                const transferIndex = gameConfig.teams.findIndex(t => t.id === transferTeam.id);
                gameConfig.currentTeamIndex = transferIndex;
                
                resultElement.innerHTML = `
                    <div>Вы передали ход команде "${transferTeam.name}"</div>
                    <div style="font-size: 2.5rem; margin: 10px 0;">⤵️</div>
                    <div>Следующий ход: ${transferTeam.name}</div>
                `;
                resultElement.classList.add('neutral');
                break;
                
            case 'I': // Инвестиционный бонус +3
                title.innerHTML = `<i class="fas fa-chart-line"></i> ИНВЕСТИЦИОННЫЙ БОНУС`;
                icon.innerHTML = '<i class="fas fa-chart-line fa-4x"></i>';
                
                team.score += 3;
                resultElement.innerHTML = `
                    <div>Отличная инвестиция!</div>
                    <div style="font-size: 3rem; margin: 10px 0;">+3 балла</div>
                    <div>Теперь у вас: ${team.score} баллов</div>
                `;
                resultElement.classList.add('positive');
                break;
                
            case 'P': // Инвестиционные потери -2
                title.innerHTML = `<i class="fas fa-chart-line"></i> ИНВЕСТИЦИОННЫЕ ПОТЕРИ`;
                icon.innerHTML = '<i class="fas fa-arrow-down fa-4x"></i>';
                
                team.score = Math.max(0, team.score - 2);
                resultElement.innerHTML = `
                    <div>Инвестиции не сработали</div>
                    <div style="font-size: 3rem; margin: 10px 0;">-2 балла</div>
                    <div>Теперь у вас: ${team.score} баллов</div>
                `;
                resultElement.classList.add('negative');
                break;
                
            default: // Пустая бонусная клетка
                title.innerHTML = `<i class="fas fa-gift"></i> БОНУС`;
                icon.innerHTML = '<i class="fas fa-gift fa-4x"></i>';
                resultElement.innerHTML = `
                    <div>Эта бонусная клетка оказалась пустой</div>
                    <div style="font-size: 2.5rem; margin: 10px 0;">🎁</div>
                    <div>Попробуйте другую клетку!</div>
                `;
                resultElement.classList.add('neutral');
                break;
        }
        
        // Обновляем счет сразу
        updateScoreDisplay();
        
        modal.style.display = 'flex';
    }

    function confirmBonus() {
        const bonus = gameState.currentBonus;
        const cell = bonus.cell;
        
        document.getElementById('bonus-modal').style.display = 'none';
        
        // Обновляем клетку
        cell.classList.remove('bonus');
        cell.classList.add('used');
        
        // Если это была передача хода, уже обновили currentTeamIndex
        if (bonus.type === 'T') {
            setActiveTeam(gameConfig.currentTeamIndex);
            showNotification(`Ход передан команде ${gameConfig.teams[gameConfig.currentTeamIndex].name}`, 'info');
        } else {
            nextTurn();
        }
    }

    // ================================
    // ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ
    // ================================
    function nextTurn() {
        gameConfig.currentTeamIndex = (gameConfig.currentTeamIndex + 1) % gameConfig.teams.length;
        setActiveTeam(gameConfig.currentTeamIndex);
        showNotification(`Теперь ходят ${gameConfig.teams[gameConfig.currentTeamIndex].name}`, 'info');
        
        // Разблокируем кнопку кубика
        document.getElementById('dice-btn').disabled = false;
    }

    function setActiveTeam(index) {
        document.querySelectorAll('.score-card').forEach(card => {
            card.classList.remove('active');
        });
        
        document.querySelectorAll('.team-turn-indicator').forEach(indicator => {
            indicator.textContent = '';
        });
        
        const activeTeam = gameConfig.teams[index];
        const activeCard = document.querySelector(`.score-card[data-team="${activeTeam.id}"]`);
        const activeIndicator = document.getElementById(`turn-${activeTeam.id}`);
        
        if (activeCard) {
            activeCard.classList.add('active');
            activeIndicator.textContent = 'Сейчас ходят';
        }
        
        document.getElementById('current-team-name').textContent = activeTeam.name;
        document.getElementById('current-team-name').style.color = getTeamColor(activeTeam.color);
        gameState.activeTeam = activeTeam;
    }

    function getTeamColor(color) {
        const colors = {
            silver: '#ffffff',
            oil: '#000000',
            apple: '#4dff88',
            nemchenko: '#ff6bcd'
        };
        return colors[color] || '#ffffff';
    }

    function updateScoreDisplay() {
        gameConfig.teams.forEach(team => {
            const scoreElement = document.getElementById(`score-${team.id}`);
            if (scoreElement) {
                scoreElement.textContent = team.score;
            }
        });
    }

    function showNotification(message, type = 'info') {
        const notification = document.getElementById('notification');
        
        const colors = {
            info: '#00b4d8',
            success: '#4caf50',
            warning: '#ff9800',
            error: '#f44336',
            dice: '#9c27b0'
        };
        
        notification.textContent = message;
        notification.style.borderLeftColor = colors[type] || colors.info;
        notification.style.display = 'block';
        
        setTimeout(() => {
            notification.style.display = 'none';
        }, 3000);
    }

    function resetGame() {
        if (confirm('Вы уверены, что хотите начать новую игру? Текущий прогресс будет потерян.')) {
            // Сброс конфигурации
            gameConfig.teams.forEach(team => {
                team.score = 0;
                if (team.id === 'silver') team.position = { row: 0, col: 0 };
                if (team.id === 'oil') team.position = { row: 10, col: 0 };
                if (team.id === 'apple') team.position = { row: 10, col: 10 };
                if (team.id === 'nemchenko') team.position = { row: 0, col: 10 };
            });
            
            gameConfig.currentTeamIndex = 0;
            gameConfig.diceResult = 0;
            
            // Переинициализация
            initializeMaps();
            createBoard();
            createPieces();
            updateScoreDisplay();
            setActiveTeam(0);
            
            // Скрытие модальных окон
            document.getElementById('question-modal').style.display = 'none';
            document.getElementById('bonus-modal').style.display = 'none';
            
            // Разблокировка кнопок
            document.getElementById('dice-btn').disabled = false;
            document.querySelectorAll('.dir-btn').forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('selected');
            });
            document.getElementById('confirm-direction').disabled = true;
            
            showNotification('Новая игра началась! Удачи!', 'success');
        }
    }

    // ================================
    // ЗАПУСК ИГРЫ
    // ================================
    initGame();
});